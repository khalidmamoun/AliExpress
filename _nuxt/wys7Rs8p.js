import{_ as U,I as k}from"./afzBCQRM.js";import{u as N}from"./CAh-G4Tp.js";import{_ as d}from"./9PtdX7Ft.js";import{r as c,g as I,c as p,b as u,w as f,l as o,a as t,t as x,o as m,d as _}from"./DP8Y3t9_.js";const P={class:"min-h-screen bg-gray-50 flex flex-col items-center py-10"},A={key:0,class:"max-w-md w-full bg-white p-6 rounded-lg shadow-md text-center"},C={class:"font-semibold text-lg mb-4"},D={class:"relative w-32 h-32 mx-auto mb-4"},S=["src"],T={for:"avatarInput",class:"absolute bottom-0 right-0 bg-blue-500 text-white p-2 rounded-full cursor-pointer hover:bg-blue-600"},$={class:"flex justify-center gap-4 mb-4"},j=["disabled"],B={key:1,class:"text-center py-10"},R={__name:"profile",setup(F){const a=N(),s=c(null),l=c("/images/default-avatar.png"),n=c(!1);I(()=>{a.user?.avatar&&(l.value=a.user.avatar+"?t="+new Date().getTime())});function h(r){s.value=r.target.files[0],s.value&&(l.value=URL.createObjectURL(s.value))}async function y(){if(!s.value)return alert("Please select a file!");n.value=!0;const r=s.value,e=r.name.split(".").pop(),i=`avatars/${`${a.user.id}.${e}`}`,{error:g}=await supabase.storage.from("avatars").upload(i,r,{upsert:!0});if(g){alert("Upload failed: "+g.message),n.value=!1;return}const{data:b}=supabase.storage.from("avatars").getPublicUrl(i);l.value=b.publicUrl+"?t="+new Date().getTime(),a.user.avatar=b.publicUrl,alert("Avatar updated successfully!"),s.value=null,n.value=!1}async function w(){if(!a.user?.avatar){l.value="/images/default-avatar.png";return}const v=`avatars/${a.user.avatar.split("/").pop()}`,{error:i}=await supabase.storage.from("avatars").remove([v]);if(i){alert("Failed to delete avatar: "+i.message);return}l.value="/images/default-avatar.png?t="+new Date().getTime(),a.user.avatar=null,alert("Avatar deleted successfully!")}return(r,e)=>(m(),p("div",P,[u(o(d),{to:"/",class:"mb-6 flex items-center gap-2"},{default:f(()=>[...e[0]||(e[0]=[t("img",{src:U,alt:"Site Logo",class:"w-36"},null,-1)])]),_:1}),o(a).user?(m(),p("div",A,[e[2]||(e[2]=t("h1",{class:"text-2xl font-bold mb-6"},"My Profile",-1)),t("p",C,x(o(a).user.email),1),t("div",D,[t("img",{src:l.value,class:"w-32 h-32 rounded-full border-2 border-gray-300 object-cover",alt:"Avatar"},null,8,S),t("label",T,[u(o(k),{icon:"ph:pencil-simple",width:"20"})])]),t("input",{id:"avatarInput",type:"file",class:"hidden",accept:"image/*",onChange:h},null,32),t("div",$,[t("button",{onClick:y,disabled:!s.value||n.value,class:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded disabled:opacity-50 cursor-pointer"},x(n.value?"Uploading...":"Save Image"),9,j),t("button",{onClick:w,class:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded disabled:opacity-50 cursor-pointer"}," Delete Image "),u(o(d),{to:"/",class:"font-bold bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded"},{default:f(()=>[...e[1]||(e[1]=[_(" Home Page ",-1)])]),_:1})])])):(m(),p("div",B,[e[4]||(e[4]=t("p",{class:"text-lg font-semibold text-gray-500"},"You are not logged in.",-1)),u(o(d),{to:"/",class:"text-blue-500 hover:underline mt-4 inline-block"},{default:f(()=>[...e[3]||(e[3]=[_("Go to Home",-1)])]),_:1})]))]))}};export{R as default};
